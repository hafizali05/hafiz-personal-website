var HeaderModule=function(){var e,n=this,i=$(".header"),o="About",t=!1,a=$(".nav-link"),s=$(".nav-link.sticky"),l=$(".deck"),r=170;this.stickyLinks=function(){o="About",t=!1,$.each(a,function(n,i){e=i.getBoundingClientRect(),e.top<=0&&(o=$(i).data("previous"),t=!0),0===n&&e.top>0&&(t=!1)}),t?($(".current-nav-link").show(),$(".current-nav-link").attr("data-link",o),$(".current-nav-link .lbldup").html(o)):$(".current-nav-link").hide()};var c=function(e){var n;n="work"===e?$("#"+e).offset().top-i.height():$("#"+e).offset().top,$("html,body").animate({scrollTop:n})};$(".nav-link").on("click",function(e){e.preventDefault(),c($(this).attr("data-link"))}),$(".current-nav-link").on("click",function(e){e.preventDefault(),c($(this).attr("data-link"))}),this.getDeck=function(){$.getJSON("./json/deck.json",function(e){$.each(e.deck,function(e,n){$(".deck-links").append('<li><a href="'+n.link+'" target="_blank" onclick="ga("send", "event", "Deck", "click", "'+n.icon+" - "+n.title+'");"><span class="deck-icon"><span class="'+n.icon+'-icon"></span></span> <span class="deck-desc"> <h4 class="lbldup">'+n.title+"</h4> <p>"+n.description+"</p> </span></a></li>")})})},this.deckToggle=function(e,n){(l.hasClass("open")||n)&&(r=mobile?winH-i.height():170,i.css({top:r}),l.height(r),l.find(".deck-wrapper").height(r)),n&&(l.hasClass("open")?($(e).removeClass("deck-open"),s.removeClass("deck-open"),i.css({top:0}).removeClass("deck-open"),l.height(0).removeClass("open"),ga("send","event","Deck","toggle","Close Deck")):($(e).addClass("deck-open"),s.addClass("deck-open"),i.css({top:r}).addClass("deck-open"),l.height(r).addClass("open"),l.find(".deck-wrapper").height(r),ga("send","event","Deck","toggle","Open Deck")))},$(".on-deck").on("click",function(e){e.preventDefault(),n.deckToggle(this,!0)})},WorkModule=function(){var e,n=this,i=[],o=$(".project"),t=$(".project.open"),a={},s=$(".project.open .project-info-wrapper"),l={},r=$(".project-header"),c="",p=["desktop","tablet","mobile"],d="desktop",h=[];this.getWork=function(){$.getJSON("./json/work.json",function(e){i=e.work,$.each(i,function(e,n){$(".projects").append('<li class="project" data-index="'+e+'"> <a href="'+n.link+'" data-slug="'+n.slug+'" class="project-link" target="_blank" onclick="ga("send", "event", "Work", "click", "Open Project: "'+n.title+');"> <h3 class="link"> <span class="txt"><span>'+n.title+'<span class="small">'+n.role+'</span></span></span> <span class="arrow"><span class="work-arrow"></span></span> </h3> </a> </li>'),e===i.length-1&&(o=$(".project"),""!==location.pathname&&location.pathname.search("work")>-1&&0!==$('.project-link[href="'+location.pathname+'"]').length&&$('.project-link[href="'+location.pathname+'"]').trigger("click"))})})},this.viewToggle=function(){$(window).width()>1024?$('.view-toggles .toggle[data-view="desktop"]').trigger("click"):$(window).width()>=768&&$(window).width()<=1024?$('.view-toggles .toggle[data-view="tablet"]').trigger("click"):$(window).width()<768&&$('.view-toggles .toggle[data-view="mobile"]').trigger("click")};var w=function(){0===t.find(".slider-wrapper."+d).length?$.ajax({url:"/helpers/get_images.php",data:{project_slug:c},success:function(e){h=JSON.parse(e),$.each(p,function(e,n){h[n].length>0&&0===t.find(".slider-wrapper."+n).length&&(t.find(".view-image").append('<div class="slider-wrapper '+n+'"></div>'),$.each(h[n],function(e,i){t.find(".slider-wrapper."+n).append('<div class="slide"><img src="/img/work/'+c+"/"+n+"/"+i+'" /></div>')})),0===h[n].length&&t.find(".toggle."+n+"-icon").remove(),e===p.length-1&&(t.find(".slider-wrapper."+d).siblings().hide(),t.find(".slider-wrapper."+d).show(),t.find(".slider-wrapper."+d).slick({dots:!1,prevArrow:'<span class="prev-arrow slider-arrow"></span>',nextArrow:'<span class="next-arrow slider-arrow"></span>',fade:!0,speed:200,infinite:!1}))})},error:function(){}}):(t.find(".slider-wrapper."+d).siblings().hide(),t.find(".slider-wrapper."+d).show(),t.find(".slider-wrapper.slick-initialized").hasClass(d)||t.find(".slider-wrapper.slick-initialized").slick("unslick"),t.find(".slider-wrapper."+d).hasClass("slick-initialized")||(console.log("reinit"),t.find(".slider-wrapper."+d).slick({dots:!1,prevArrow:'<span class="prev-arrow slider-arrow"></span>',nextArrow:'<span class="next-arrow slider-arrow"></span>',fade:!0,speed:200,infinite:!1})))};$("body").on("click",".view-toggles .toggle",function(e){e.preventDefault(),d=$(this).attr("data-view"),$(this).siblings().removeClass("active"),$(this).addClass("active"),$(".view-browser").attr("data-view",d),w(d)}),this.projectScroll=function(e){t=$(".project.open"),s=$(".project.open .project-info-wrapper"),t.length>0&&!mobile?(a=t[0].getBoundingClientRect(),l=s[0].getBoundingClientRect(),a.top>60||a.bottom<160?(t.removeClass("locked"),r.slideUp(200)):(a.top<=60||a.bottom>=winH)&&(t.addClass("locked"),r.slideDown(200))):(t.removeClass("locked"),r.slideUp(200))};var g=function(e,n){e.hasClass("open")?($("html,body").scrollTop(e.offset().top-$(".header").outerHeight()),r.hide(),e.removeClass("locked"),e.removeClass("open"),e.removeClass("locked"),e.find(".project-info-wrapper").animate({height:0}),e.find(".arrow").removeClass("close"),ga("send","event","Work","click","Close Project: "+n.title)):(t.length>0?(t.removeClass("open"),t.find(".arrow").removeClass("close"),t.find(".project-info-wrapper").animate({height:0},400,"swing",function(){$("html,body").animate({scrollTop:e.offset().top-60},700,"easeInCubic",function(){$(".project-header h3 .txt").html(n.title),mobile||(r.show(),e.addClass("locked"))}),k(e,n)})):($("html,body").animate({scrollTop:e.offset().top-60},700,"easeInCubic",function(){$(".project-header h3 .txt").html(n.title),mobile||(r.show(),e.addClass("locked"))}),k(e,n)),ga("send","event","Work","click","Open Project: "+n.title))},k=function(i,o){if(0===i.find(".project-info-wrapper").length){var a='<div class="project-info-wrapper"><div class="wrapper"> <div class="images-wrapper"> <div class="view-toggles"> <span class="toggle desktop-icon" data-view="desktop"></span> <span class="toggle tablet-icon" data-view="tablet"></span> <span class="toggle mobile-icon" data-view="mobile"></span> </div> <div class="view-browser"> <div class="view-header"> <span class="btn"></span> <span class="btn"></span> <span class="btn"></span> </div> <div class="view-image"></div> </div> </div> <div class="info-wrapper"> <a href="'+o.link+'" target="_blank" class="simple-btn launch-btn lbldup">Launch Project</a> <div class="inner-wrapper"> <p>'+o.description+'</p> <div class="meta"> <div class="for column"> <h4 class="lbldup">For</h4> <p>'+o["for"]+'</p> </div> <div class="role column"> <h4 class="lbldup">Role(s)</h4> <p>'+o.role+"</p> </div> </div> </div> </div> </div></div>";i.append(a)}var s=i.find(".project-info-wrapper .wrapper").innerHeight();i.find(".project-info-wrapper").animate({height:s},function(){i.addClass("open"),i.find(".arrow").addClass("close"),e=s,t=i,c=o.slug,n.viewToggle()})};$(".work").on("click",".project a.project-link",function(e){}),window.addEventListener("popstate",function(e){var n=e.state;if(null!==n){var t=i[n];document.title=t.title,g($(o[n]),t)}}),$(".project-header").on("click",".close-icon",function(e){e.preventDefault();var n=i[t.parent().data("index")];g(t,n)})},winW=$(window).width(),winH=$(window).height(),scrollTop=$(window).scrollTop(),prevScrollTop=$(window).scrollTop(),mobile=winW>=768?!1:!0,header_module=new HeaderModule,work_module=new WorkModule,s=0,h1_spans=$("h1 span"),animate_spans,setupHeights=function(){if(mobile?($(".about").height("auto"),$(".contact").height("auto")):winH>620?($(".about").height(winH),$(".contact").height(winH)):($(".about").height(620),$(".contact").height(620)),$(".project.open").length>0){var e=$(".project.open .project-info-wrapper .wrapper").innerHeight();$(".project.open .project-info-wrapper").height(e),new_project_h=e}},animateIntro=function(){s=0,h1_spans=$("h1 span"),animate_spans=setInterval(function(){s<h1_spans.length?($(h1_spans[s]).fadeTo(400,1),s++):(clearInterval(animate_spans),$(".about .inner-wrapper").animate({opacity:1,bottom:0},400,"swing"))},500)},init=function(){setupHeights(),animateIntro(),header_module.getDeck(),header_module.deckToggle(),work_module.getWork(),work_module.viewToggle()};$(window).on("scroll",function(){scrollTop=$(window).scrollTop(),header_module.stickyLinks(),work_module.projectScroll(),prevScrollTop=$(window).scrollTop()}),$(window).on("resize",function(){winW=$(window).width(),winH=$(window).height(),mobile=winW>=768?!1:!0,setupHeights(),header_module.deckToggle($(".on-deck"),!1),work_module.viewToggle()}),$(document).ready(function(){init()});